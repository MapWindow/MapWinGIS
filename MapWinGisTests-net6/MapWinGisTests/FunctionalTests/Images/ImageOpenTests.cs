namespace MapWinGisTests.FunctionalTests.Images;

[Collection(nameof(NotThreadSafeResourceCollection))]
public class ImageOpenTests
{
    private readonly ITestOutputHelper _testOutputHelper;

    public ImageOpenTests(ITestOutputHelper testOutputHelper)
    {
        _testOutputHelper = testOutputHelper;
    }

    [Fact]
    public void OpenGeoTiffAsImage()
    {
        var imgLocation = Helpers.GetTestFilePath("5band.tif");

        var img = Helpers.LoadImageUsingFileManager(imgLocation);
        img.ShouldNotBeNull();
        Helpers.CheckEpsgCode(img.GeoProjection, 32632, false);
        _testOutputHelper.WriteLine(img.GeoProjection.ExportToWktEx());

        img.IsEmpty.ShouldBeFalse("Tiff is empty");
        img.NoBands.ShouldBe(5);
        img.GdalDriver.IsRaster.ShouldBeTrue();
        img.GdalDriver.Name.ShouldBe("GTiff");

        img.ActiveBand.DataType.ShouldBe(tkGdalDataType.gdtFloat32);
        img.ActiveBand.Scale.ShouldBe(1);
    }
}
